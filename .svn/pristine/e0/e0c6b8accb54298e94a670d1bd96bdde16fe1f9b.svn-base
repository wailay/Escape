/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package States;

import Entities.Entity;
import Graphique.Item.Item;
import Level.Manager;
import Level.Map;
import Level.Prison.PrisonZone1;
import escape.Fenetre;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.Input;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.state.BasicGameState;
import org.newdawn.slick.state.StateBasedGame;

/**
 *
 * @author Wail
 */
public class PrisonZone1State extends BasicGameState {

    Map map;
    PrisonZone1 prisonMap;

    @Override
    public int getID() {
        return Etat.PRISON_ZONE_1;
    }

    @Override
    public void init(GameContainer gc, StateBasedGame s) throws SlickException {
        map = new Map(gc);
        prisonMap = new PrisonZone1(gc);

    }

    @Override
    public void render(GameContainer gc, StateBasedGame s, Graphics g) throws SlickException {
        g.scale(2f, 2f);
        g.translate(Fenetre.offsetX - map.getPlayer().getX(), Fenetre.offsetY- map.getPlayer().getY());

        map.render(g, prisonMap);
        map.getPlayer().render(g);

        for (Item item : prisonMap.getListeItem()) {

            item.render(g);
        }
        for(Entity en : prisonMap.getListeEntities()){
            en.render(g);
        }

        prisonMap.dbug(gc, g);

    }

    @Override
    public void update(GameContainer gc, StateBasedGame s, int d) throws SlickException {
        
        map.getClavier().load(gc);

        map.getPlayer().update(map.getClavier().keys, d, prisonMap, gc);
        if (gc.getInput().isKeyPressed(Input.KEY_0)) {
            s.enterState(Etat.START_ZONE);
        }

        if (prisonMap.isPlayerTped(prisonMap, map.getPlayer())) {
            map.getPlayer().setX(400);
            map.getPlayer().setY(400);
            s.enterState(Etat.START_ZONE);

        }
        for(Entity en : prisonMap.getListeEntities()){
            en.update(d,prisonMap,map.getPlayer());
        }
        Etat.stateManager(s, gc, map.getClavier());
    }

}
