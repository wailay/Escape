/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Entities;

import Graphique.AnimationLoader;
import Graphique.Item.Item;
import Level.Map;
import Level.Prison.PrisonMap;
import Sound.SoundLoader;
import States.Inventaire;
import org.newdawn.slick.Animation;
import org.newdawn.slick.Color;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;

import org.newdawn.slick.SlickException;
import org.newdawn.slick.SpriteSheet;
import org.newdawn.slick.geom.Rectangle;
import org.newdawn.slick.geom.Circle;
import org.newdawn.slick.tiled.TiledMap;

/**
 *
 * @author wail
 */
public class Player extends Entity {
    
    
    
    private int width, height, radius = 25, baseDamage = 10, baseHP = 100, baseArmor = 25;
    
    private boolean up, down, left, right, hit;
    
    private Color playerHitColor;

    public Player(String path, int width, int height) throws SlickException {
        
        super(95,60);
        this.duration = 130;
        this.vitesseX = 0.2f;
        this.vitesseY = 0.2f;
        anim = new Animation[8];
        
        this.width = width;
        this.height = height;
        createEntity(path, width, height);
       
    }
    

    @Override

    public void render(Graphics g) throws SlickException {
         this.box = new Rectangle(x, y, width, height);

        triggerRadius = new Circle(x + (width / 2), y + (height / 2), radius);
        
        g.drawAnimation(anim[direction + (moving ? 4 : 0)], x, y, playerHitColor);
            
        
        
       
        
    }

    @Override
    public void createEntity(String path, int tw, int th) throws SlickException {
        hero = new SpriteSheet(path, tw, th);
        anim[0] = AnimationLoader.loadAnimation(hero, 1, 2, 0, duration);
        anim[1] = AnimationLoader.loadAnimation(hero, 1, 2, 1, duration);
        anim[2] = AnimationLoader.loadAnimation(hero, 1, 2, 2, duration);
        anim[3] = AnimationLoader.loadAnimation(hero, 1, 2, 3, duration);
        anim[4] = AnimationLoader.loadAnimation(hero, 0, 3, 0, duration);
        anim[5] = AnimationLoader.loadAnimation(hero, 0, 3, 1, duration);
        anim[6] = AnimationLoader.loadAnimation(hero, 0, 3, 2, duration);
        anim[7] = AnimationLoader.loadAnimation(hero, 0, 3, 3, duration);
        

    }

    public void update(boolean[] keys, int d, Map map, GameContainer gc) throws SlickException {

        move(keys[0], keys[2], keys[1], keys[3], keys[9], keys[14], d, map);

        updateTrigger(d, keys[10],keys[15], this, map,gc);

    }

    public void updateTrigger(int d, boolean e,boolean f, Entity player, Map map,GameContainer gc) throws SlickException {

        if (e) {
            
            map.checkTrigger(this, map);
            
        }
        if(f){
             
             map.itemPickUp(this,map);
             Inventaire.addToItemHolder(gc);
        }

    }

    public void move(boolean up, boolean down, boolean right, boolean left, boolean moving, boolean shift, int d, Map map) {
        this.moving = moving;
        if (shift) {
            vitesseX = 0.4f;
            vitesseY = 0.4f;
        } else {
            vitesseX = 0.2f;
            vitesseY = 0.2f;
        }
        if (this.moving) {
            if (up) {
                direction = 0;
                y -= vitesseY * d;

            }
            if (right) {
                direction = 1;
                x += vitesseX * d;
            }
            if (down) {
                direction = 2;
                y += vitesseY * d;
            }

            if (left) {
                direction = 3;
                x -= vitesseX * d;

            }
            
                  map.checkCollision(this);
            
          
            map.checkTriggerCollision(this);

        }

    }

    public void setHitPoints(int hitPoints) {
        this.hitPoints = hitPoints;
    }

    public void setHit(boolean hit) {
        this.hit = hit;
    }
    
    

    public boolean isHit() {
        return hit;
    }

    public Color getPlayerHitColor() {
        return playerHitColor;
    }

    public void setPlayerHitColor(Color playerHitColor) {
        this.playerHitColor = playerHitColor;
    }
    
    
    
      public String getBaseStats(){
        
        return "Player stats\n\n"
                +baseDamage+" Damage\n\n"
                +baseHP+" Health points\n\n"
                +baseArmor+" Strength\n\n";
    }
    public String getStats(Item item){
        
        return "Player stats\n\n"
                +(baseDamage+item.getDamage())+" Damage\n\n"
                +(baseHP+((item.getVitality()*baseHP)/100))+" Health points\n\n"
                +(baseArmor+(item.getArmor()))+" Strength\n\n";
    }
    
    public void getLoot(){
        
    }

    public float getX() {
        return x;
    }

    public float getY() {
        return y;
    }

    public void setX(float x) {
        this.x = x;
    }

    public void setY(float y) {
        this.y = y;
    }

    public boolean isMoving() {
        return moving;
    }

    public Circle getTriggerRadius() {
        return triggerRadius;
    }

    public int getBaseArmor() {
        return baseArmor;
    }

    public int getBaseDamage() {
        return baseDamage;
    }

    public int getBaseHP() {
        return baseHP;
    }

    public void setBaseHP(int baseHP) {
        this.baseHP = baseHP;
    }
    
    
    
    

}
